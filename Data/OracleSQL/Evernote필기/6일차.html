<html>
<head>
  <title>6일차</title>
  <basefont face="Segoe UI" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/308474 (ko-KR, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: Segoe UI;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="816"/>
<h1>6일차</h1>

<div>
<span><div><div><div>PL / SQL </div><ul><li><div>커서</div></li><ul><li><div>인터페이스등에사용</div></li><li><div>FOR A IN LOOP</div></li><li><div>--명시적 커서의 OPEN,FETCH가 자동적으로 수행 됨</div></li><li><div>STATEMENT1;</div></li><li><div>STATEMENT2;</div></li><li><div>.....</div></li><li><div>END LOOP;</div></li></ul></ul><div><br/></div><div><br/></div><ul><ul><li><div>DBMS_OPT.PUT_LINE &lt; SYSOUT</div></li></ul></ul><div>프로시저는 IN / OUT밖에 없고</div><div>다른건 RETURN이 있다. (public void 등)</div><div><br/></div></div><div><br/></div><div><img src="6일차_files/Image.png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><br/></div><div><img src="6일차_files/Image [1].png" type="image/png" data-filename="Image.png" width="405"/></div><div><br/></div><div><img src="6일차_files/Image [2].png" type="image/png" data-filename="Image.png"/> </div><div><br/></div><div><br/></div><div><br/></div><div><img src="6일차_files/Image [3].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><br/></div><div><img src="6일차_files/Image [4].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><hr/><div><br/></div><div><br/></div><div>accept bun prompt '사원번호 입력 :'</div><div>declare</div><div>    vsabun sawon.sabun%type;</div><div>    vsaname sawon.saname%type;</div><div>    vsapay sawon.sapay%type;</div><div><br/></div><div>begin</div><div><br/></div><div>    --select ~ into : into 뒤에 기술한 변수에 select 값을 대입</div><div>    select sabun, saname, sapay into vsabun, vsaname, vsapay</div><div>    from sawon where sabun = &amp;bun;</div><div>    --출력</div><div>    dbms_output.put_line('실행결과');</div><div>    dbms_output.put_line('사원번호 : '||vsabun);</div><div>    dbms_output.put_line('이름 : '|| vsaname);</div><div>    dbms_output.put_line('급여 : '|| vsapay);</div><div>    </div><div><br/></div><div>end;</div><div>/</div><hr/><div><br/></div><div><img src="6일차_files/Image [5].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><hr/><div>accept bun prompt '사원번호 입력 :'</div><div>declare</div><div>    vsawon sawon%rowtype;</div><div>begin</div><div><br/></div><div>    --select ~ into : into 뒤에 기술한 변수에 select 값을 대입</div><div>    select * into vsawon</div><div>    from sawon where sabun = &amp;bun;</div><div>    --출력</div><div>    dbms_output.put_line('실행결과');</div><div>    dbms_output.put_line('사원번호 : '||vsawon.sabun);</div><div>    dbms_output.put_line('이름 : '|| vsawon.saname);</div><div>    dbms_output.put_line('직책 : '|| vsawon.sajob);</div><div>    dbms_output.put_line('급여 : '|| vsawon.sapay);</div><div>    </div><div><br/></div><div>end;</div><div>/</div><div><img src="6일차_files/Image [6].png" type="image/png" data-filename="Image.png"/></div><hr/><div>/*</div><div>    사원테이블에서 입력받은 사원의 평균 급여를 계산해주는 PL/SQL을 만드시오.</div><div>    단, %TYPE을 써서 작성해보기</div><div>*/</div><div><br/></div><div>accept bun prompt '부서번호'</div><div>declare</div><div>    vdeptno sawon.deptno%type;</div><div>    vdname dept.dname%type;</div><div>    vavg sawon.sapay%type;</div><div><br/></div><div><br/></div><div>begin    </div><div>    select s.deptno deptno, d.dname dname , avg(nvl(s.sapay,0))</div><div>    into vdeptno, vdname, vavg</div><div>    from sawon s, dept d where s.deptno = d.deptno and s.deptno = &amp;bun</div><div>    group by s.deptno, d.dname;</div><div>    ----출력</div><div>    dbms_output.put_line('실행결과');</div><div>        dbms_output.put_line('부서번호 : '||vdeptno);</div><div>        dbms_output.put_line('이름 : '|| vdname);</div><div>        dbms_output.put_line('직책 : '|| vavg);</div><div>end;</div><div><br/></div><div>/</div><div><br/></div><hr/><div><br/></div><div>PL/SQL 한번실행하면 땡</div><div>PROCEDURE (프로시저) - 메모리에 저장함.</div><div><br/></div><div><br/></div><div><img src="6일차_files/Image [7].png" type="image/png" data-filename="Image.png"/></div><div><img src="6일차_files/Image [8].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><br/></div><div><img src="6일차_files/Image [9].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><br/></div><div><br/></div><hr/><div><img src="6일차_files/Image [10].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><hr/><div><img src="6일차_files/Image [11].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><img src="6일차_files/Image [12].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><hr/><div><br/></div><div><br/></div><div><img src="6일차_files/Image [13].png" type="image/png" data-filename="Image.png"/></div><div><img src="6일차_files/Image [14].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><br/></div><hr/><div>트리거</div><div>/*****</div><div>Trigger(트리거)</div><div>지정한 이벤트 (DML)가 발생하면 수행되는 명령어들을 포함하는 객체</div><div>호출문이 없다 (자동호출)</div><div>데이터 흐름 제어명령(TCL)은 사용할 수 없다!</div><div>목적</div><div>1. 데이터 무결성 구현 (제한조건으로 구현할 수 없는 경우)</div><div>2. 업무 자동화 (연금계산, 급여계산,..회계관리 등 연쇄작용하는 업무에 많이 사용)</div><div>3. 보안 (감사)성 강화하는데 사용 (이벤트를 발생한 유저 기록 관리)</div><div>4. 데이터 복제 구현</div><div>형식</div><div>create or replace trigger t1</div><div>[before|after] insert or delete or update on table_name</div><div>for each row ***행 단위의 트리거</div><div>declare</div><div>지역변수 선언;</div><div>begin</div><div>명령;</div><div>end;</div><div><br/></div><div>old.컬럼명 : 삭제된 행의 컬럼값, 행 단위 트리거에서만 사용 가능! 이전 데이터</div><div>new.컬럼명 : SQL 반영이된 이후에 컬럼 데이터</div><div><br/></div><div>create table gogek_ex as select * from gogek;</div><div>*/</div><div><br/></div><div>create or replace trigger gogek_i</div><div>    after insert on gogek</div><div>    for each row</div><div><br/></div><div>begin</div><div><br/></div><div>    insert into gogek_ex</div><div>    values(:new.gobun,:new.goname,:new.gotel,:new.gojumin,:new.godam);</div><div>end;</div><div>/</div><div><br/></div><div><br/></div><div><img src="6일차_files/Image [15].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>/*****</div><div>Trigger(트리거)</div><div>지정한 이벤트 (DML)가 발생하면 수행되는 명령어들을 포함하는 객체</div><div>호출문이 없다 (자동호출)</div><div>데이터 흐름 제어명령(TCL)은 사용할 수 없다!</div><div>목적</div><div>1. 데이터 무결성 구현 (제한조건으로 구현할 수 없는 경우)</div><div>2. 업무 자동화 (연금계산, 급여계산,..회계관리 등 연쇄작용하는 업무에 많이 사용)</div><div>3. 보안 (감사)성 강화하는데 사용 (이벤트를 발생한 유저 기록 관리)  </div><div>4. 데이터 복제 구현</div><div>형식</div><div>create or replace trigger t1</div><div>[before|after] insert or delete or update on table_name</div><div>for each row ***행 단위의 트리거</div><div>declare</div><div>지역변수 선언;</div><div>begin</div><div>명령;</div><div>end;</div><div><br/></div><div>old.컬럼명 : 삭제된 행의 컬럼값, 행 단위 트리거에서만 사용 가능! 이전 데이터</div><div>new.컬럼명 : SQL 반영이된 이후에 컬럼 데이터</div><div><br/></div><div>create table gogek_ex as select * from gogek;</div><div>*/</div><div><br/></div><div>create or replace trigger gogek_d</div><div>    after delete on gogek</div><div>    for each row</div><div><br/></div><div>begin</div><div><br/></div><div>    delete(:old.gobun,:old.goname,:old.gotel,:old.gojumin,:old.godam);</div><div>end;</div><div>/</div><div><br/></div><div><br/></div><div><img src="6일차_files/Image [16].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div></div></span>
</div></body></html> 